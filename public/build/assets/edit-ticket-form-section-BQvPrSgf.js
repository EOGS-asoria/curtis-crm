import{r as i,q as E,s as P,j as e,z as T,y as D}from"./store-CorJ7S5Q.js";import{I as t}from"./input-DpZ2Qmdp.js";import{a as I,u as f}from"./app-rncPq0Rm.js";import{S as m}from"./select-MJHCoATa.js";import F from"./tickets-create-search-product-section-CEd9DhDL.js";import{T as H}from"./textarea-a3mrHuln.js";import{g as L}from"./ticket-form-thunk-Dd4ESaHi.js";import{c as b}from"./country-Ckao6GDp.js";import{c as z}from"./call_type-Hx28cB9H.js";import{L as R}from"./loading-DZuXKO1n.js";import{g as j,b as O}from"./tickets-service-BEB5ZAFm.js";import A from"./reason-to-close-BzMKrPRV.js";import{a as J}from"./product-search-CjdPs_Lo.js";import{S as U}from"./skeleton-NDuSGMgK.js";import{S as v}from"./index-BFJ8Sz8W.js";import"./modal-bCr1bsVh.js";import"./transition-CHQexzJ9.js";import"./dialog-DvLi0VXB.js";import"./MagnifyingGlassIcon-DHHsHaIk.js";import"./routing-BzgBYGmF.js";import"./compact-item-PVVCWA33.js";import"./index-B0_OPhdT.js";import"./motion-L0wigdRl.js";import"./useIcons-BewCVoPt.js";function pe(){const g=I(),[s,d]=i.useState({store:"",isHasEmail:"true"}),{common_issues:N}=f(a=>a.common_issues),{ticket:y}=f(a=>a.tickets),[C,o]=i.useState(!1),c=window.location.pathname.split("/")[4],[q,w]=i.useState([]),{url:u}=E(),[_,x]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const l=await j(u.split("/")[u.split("/").length-2].split("#")[0]);g(T(l))}catch(l){console.error("Error fetching data:",l)}})()},[u]),i.useEffect(()=>{async function a(l){const n=await j(c);d(n)}a()},[]),i.useEffect(()=>{async function a(l){x(!0);const n=await J();w(n.map(h=>({name:h,value:h}))),x(!1)}a()},[]);function r(a,l){d({...s,[l]:a})}i.useEffect(()=>{P.dispatch(L())},[]);async function S(a){a.preventDefault(),o(!0);const l={...s,id:c,status:y.status};try{await O(l),o(!1),D.visit(`/administrator/tickets/details/${c}/details`)}catch{o(!1)}}const M=a=>b.find(l=>l.value===a),{regions:k}=M(s.country??"CA");function p(a){d({...s,issue:JSON.stringify(a)})}return console.log("form.issue",s.issue),e.jsx("form",{onSubmit:S,className:" w-full px-8 pt-6 pb-8 mb-4 flex flex-col gap-3",children:_?e.jsx(U,{}):e.jsxs("div",{className:"min-h-screen h-full",children:[e.jsx("div",{className:"flex items-center justify-center font-black text-3xl my-6",children:"EDIT TICKET FORM"}),e.jsxs("div",{className:" md:flex mb-3",children:[e.jsx("div",{className:"md:w-1/2 px-3 mb-3",children:e.jsx(t,{required:!0,onChange:r,name:"fname",value:s.fname,label:"First Name",type:"text",errorMessage:"First Name is required"})}),e.jsx("div",{className:"md:w-1/2 px-3",children:e.jsx(t,{required:!0,onChange:r,name:"lname",value:s.lname,label:"Last Name",type:"text",errorMessage:"Last Name is required"})})]}),e.jsxs("div",{className:" md:flex mb-3",children:[e.jsx("div",{className:"md:w-1/2 px-3 mb-3",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"basis-1/3",children:e.jsx(m,{onChange:r,name:"isHasEmail",required:!1,value:s.isHasEmail??!0,label:"Has Email?",errorMessage:"",data:[{value:!0,name:"Yes"},{value:!1,name:"No"}]})}),e.jsx("div",{className:"basis-full",children:s.isHasEmail=="true"?e.jsx(t,{required:!0,onChange:r,name:"email",value:s.email,label:"Email",type:"email",errorMessage:"Email is required"}):e.jsx(e.Fragment,{})})]})}),e.jsx("div",{className:"md:w-1/2 px-3",children:e.jsx(t,{onChange:r,name:"phone",required:!0,value:s.phone,label:"Phone Number",type:"phone",errorMessage:"Phone Number is required"})})]}),e.jsxs("div",{className:" md:flex mb-3",children:[e.jsx("div",{className:"md:w-1/4 px-3 mb-3",children:e.jsx(F,{})}),e.jsx("div",{className:"basis-full",children:e.jsx("div",{className:"md:wfull px-3 mb-3",children:e.jsx(m,{onChange:r,name:"store",value:s.store,label:"Store Name",errorMessage:"Store Name is required",data:q})})})]}),e.jsxs("div",{className:" md:flex mb-3",children:[e.jsx("div",{className:"md:w-1/2 px-3 mb-3",children:e.jsx(t,{onChange:r,name:"item_number",required:!0,value:s.item_number,label:"Item Number",type:"text",errorMessage:"Item Number is required"})}),e.jsx("div",{className:"md:w-1/2 px-3",children:e.jsx(t,{onChange:r,name:"unit",required:!0,value:s.unit,label:"Item Unit",type:"text",errorMessage:"Item Unit is required"})})]}),e.jsxs("div",{className:" md:flex mb-3",children:[e.jsx("div",{className:"md:w-1/2 px-3 mb-3",children:e.jsx(t,{onChange:r,name:"brand",required:!0,value:s.brand,label:"Brand",type:"text",errorMessage:"Brand is required"})}),e.jsx("div",{className:"md:w-1/2 px-3",children:e.jsx(t,{onChange:r,name:"class",required:!0,value:s.class,label:"Item Class",type:"text",errorMessage:"Item Class is required"})})]}),e.jsxs("div",{className:" md:flex mb-3",children:[e.jsx("div",{className:"md:w-2/6 px-3 mb-3",children:e.jsx(t,{onChange:r,name:"serial_number",required:!0,value:s.serial_number,label:"Serial Number",type:"text",errorMessage:"Serial Number is required"})}),e.jsx("div",{className:"md:w-2/6 px-3",children:e.jsx(m,{onChange:r,name:"call_type",required:!0,value:s.call_type,label:"Call Type",errorMessage:"Call Type is required",data:z})}),e.jsx("div",{className:"md:w-2/6 px-3",children:e.jsx(t,{onChange:r,name:"purchase_date",value:s.purchase_date,label:"Purchase Date",type:"date",errorMessage:"Purchase Date is required"})})]}),e.jsxs("div",{className:" md:flex mb-3",children:[e.jsx("div",{className:"md:w-1/4 px-3 mb-3",children:e.jsx(t,{onChange:r,name:"zip_code",required:!0,value:s.zip_code,label:"Zip Code / Postal Code",type:"text",errorMessage:"Zip Code is required"})}),e.jsx("div",{className:"md:w-1/4 px-3",children:e.jsx(m,{onChange:r,name:"country",required:!0,value:s.country,label:"Country",errorMessage:"Country is required",data:b.map(a=>({name:a.name,value:a.value}))})}),e.jsx("div",{className:"md:w-1/4 px-3",children:e.jsx(m,{onChange:r,name:"state",required:!0,value:s.state,label:"State",errorMessage:"State is required",data:k})}),e.jsx("div",{className:"md:w-1/4 px-3",children:e.jsx(t,{onChange:r,name:"city",required:!0,value:s.city,label:"City",type:"text",errorMessage:"City is required"})})]}),e.jsxs("div",{className:"flex flex-col gap-4 mb-3",children:[e.jsx("div",{className:"md:w-full px-3 mb-3",children:e.jsx(t,{onChange:r,name:"address",value:s.address,label:"Address",type:"text"})}),e.jsxs("div",{className:"md:w-full px-3 mb-3",children:[(s==null?void 0:s.issue)&&s.call_type=="Parts"&&e.jsx(v,{mode:"multiple",size:"large",placeholder:"Please select",defaultValue:JSON.parse(s.issue??"[]")??[],onChange:p,style:{width:"100%"},options:[{value:"Missing Parts",label:"Missing Parts"},{value:"Damage Parts",label:"Damage Parts"},{value:"Want to buy Parts",label:"Want to buy Parts"}]}),(s==null?void 0:s.issue)&&s.call_type!=="Parts"&&e.jsx(v,{mode:"multiple",size:"large",placeholder:"Please select",defaultValue:JSON.parse(s.issue??"[]")??[],onChange:p,style:{width:"100%"},options:N.map(a=>({value:a.id,label:a.name}))})]}),e.jsx("div",{className:"md:w-full flex px-3 mb-3 gap-5",children:e.jsx("div",{className:"basis-full",children:e.jsx(H,{required:!0,onChange:r,name:"remarks",value:s.remarks,label:"Remarks",type:"text",errorMessage:"Remarks is required"})})}),e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("button",{type:"submit",className:"p-3 flex items-center justify-center w-36 bg-blue-500 text-white rounded-sm hover:to-blue-600",children:C?e.jsx("div",{className:"py-1.5",children:e.jsx(R,{})}):"UPDATE"}),e.jsx(A,{data:s})]})]})]})})}export{pe as default};
