import{c as g,r as d,u as v,j as t,N as o,K as C,H as h}from"./app-DteGzxXq.js";import{I as r}from"./input-Uwsl9B0e.js";import{L as f}from"./loading-XbI4yXKR.js";import{S as b}from"./select-D1VrP2Ba.js";import{T as w}from"./textarea-Vq5v0dYB.js";import{g as N}from"./fedex-rate-service-qYoSmiMQ.js";import{W as S}from"./wysiwyg-k_tQF_-M.js";async function q(e){return(await axios.post("/api/replacement",e)).data}async function A(e){return(await axios.get(`/api/replacement/${e}`)).data.status}function L(){const{replacement:e}=g(s=>s.tickets),[l,c]=d.useState(!1),[x,u]=d.useState(!1),n=v(),{email_templates:m}=g(s=>s.email_templates);d.useEffect(()=>{async function s(){const a=await A(e.id);n(o({...e,instruction:(a==null?void 0:a.instruction)??" ",notes:(a==null?void 0:a.notes)??" ",shipping_cost:(a==null?void 0:a.shipping_cost)??0,estimated_cost:(a==null?void 0:a.estimated_cost)??0,template_text:" "}))}s()},[]);function i(s,a){a=="wysiwyg"?n(o({...e,template_text:s})):(s||s=="")&&a&&n(o({...e,[a]:s}))}function p(s){const a=m.find(j=>j.id==s);n(o({...e,template_text:a.template_text}))}async function _(){c(!0);try{const s=await N(e);n(o({...e,shipping_cost:`${parseFloat(s.rates.FEDEX_GROUND.PAYOR_ACCOUNT_PACKAGE).toFixed(2)}`,estimated_cost:`${(parseFloat(s.rates.FEDEX_GROUND.PAYOR_ACCOUNT_PACKAGE)+parseFloat(e.unit_cost)).toFixed(2)}`}))}catch{alert("No rates Found!")}c(!1)}async function y(s){s.preventDefault(),u(!0);try{const a=await q({...e,decision_status:"REPLACEMENT"});n(C(a.status)),u(!1),e.instruction=="US Warehouse"||e.instruction=="CA Warehouse"?h.visit("#warehouse"):h.visit("#refund")}catch{u(!1)}}return t.jsx(t.Fragment,{children:t.jsxs("form",{onSubmit:y,className:"container border-2 border-slate-400  p-4 bg-white",children:[t.jsx("div",{className:"sm:flex sm:items-center sm:justify-between border-b border-gray-900/10",children:t.jsx("div",{className:"w-full flex justify-center",children:t.jsx("div",{className:"flex items-center gap-x-3 mt-4 my-4",children:t.jsx("h1",{className:"text-2xl md:text-3xl pl-2 my-2 border-l-4  font-sans font-bold border-teal-400  ",children:"REPLACEMENT"})})})}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx(r,{onChange:i,name:"unit_cost",span:"$",required:!0,value:(e==null?void 0:e.unit_cost)??"0",label:"Cost of Unit",type:"text",errorMessage:"Cost of Unit is required"}),t.jsx(r,{onChange:i,name:"cubed_weight",required:!0,value:(e==null?void 0:e.cubed_weight)??"0",label:"Cube Weight",type:"number",errorMessage:"Cube Weight is required"}),t.jsx("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Dimension"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(r,{onChange:i,name:"length",required:!0,value:(e==null?void 0:e.length)??"0",label:"Length",type:"number",errorMessage:"Length is required"}),t.jsx(r,{onChange:i,name:"width",required:!0,value:(e==null?void 0:e.width)??"0",label:"Width",type:"number",errorMessage:"Width is required"}),t.jsx(r,{onChange:i,name:"height",required:!0,value:(e==null?void 0:e.height)??"0",label:"Height",type:"number",errorMessage:"Height is required"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:_,type:"button",className:`w-96 flex items-center justify-center mr-12 py-2 ${l?"bg-blue-500":" bg-transparent  hover:bg-blue-50"}  text-blue-700 font-semibold px-4 border border-blue-500 rounded w-lg  shadow-sm shadow-black`,children:l?t.jsx(f,{}):"GET FEDEX RATES"}),t.jsx(r,{onChange:i,name:"shipping_cost",span:"$",required:!0,value:String(e==null?void 0:e.shipping_cost)??"0",label:"Shipping Cost",type:"number",errorMessage:"Shipping Cost is required"}),t.jsx(r,{onChange:i,name:"estimated_cost",span:"$",required:!0,value:String(e==null?void 0:e.estimated_cost)??"0",label:"Estimated Cost",type:"number",errorMessage:"Estimated Cost is required"})]}),t.jsx(b,{onChange:i,name:"instruction",required:!1,value:e.instruction??"",label:"Warranty Instruction",errorMessage:"",data:[{value:"",name:""},...e.country==="CA"?[{value:"CA Warehouse",name:"Return to (CA Warehouse)"}]:[],...e.country==="US"?[{value:"US Warehouse",name:"Return to (US Warehouse)"}]:[],{value:"home",name:"Destroy in Home"},{value:"asc",name:"Refer to ASC"}]}),t.jsx(b,{onChange:p,name:"email_template",value:"",label:"Email Templates",errorMessage:"",data:m.map(s=>({name:s.template_name,value:s.id}))}),t.jsx(S,{label:"",name:"wysiwyg",value:(e==null?void 0:e.template_text)??" ",onChange:i}),t.jsx("div",{className:"my-12",children:t.jsx(w,{required:!0,onChange:i,name:"notes",value:e.notes??" ",label:"Notes",type:"text",errorMessage:"Notes is required"})}),t.jsxs("div",{className:"mb-2 flex items-center justify-end gap-x-6",children:[t.jsx("button",{type:"button",className:"text-sm font-semibold leading-6 text-gray-900",children:"Cancel"}),t.jsx("button",{type:"submit",className:"rounded-sm bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:x?t.jsx(f,{}):"Submit"})]})]})]})})}export{L as default};
