import{c as f,u as y,r as d,j as e,M as m,K as x}from"./app-CER5wfLx.js";import{I as o}from"./input-M4WozrKw.js";import{S as O}from"./select-DGw9FJxF.js";import{s as p}from"./internals-service-B9kSbxh_.js";import{Q as g}from"./QueueListIcon-gnCKpN5h.js";import{T as I}from"./TrashIcon-m_ywlaI_.js";function k(){const{ticket:l,internals:N}=f(a=>a.tickets),{user:u}=f(a=>a.app),c=y(),[b,j]=d.useState(!0),[s,r]=d.useState({internal_notes:"",ticket_id:l.id,parts:[{ticket_id:l.id,name:null,part_number:null,location:null,cost:null,status:"Parts Available"}]});d.useEffect(()=>{async function a(t){await r({ticket_id:l.id,data:s,parts:N.map(n=>({id:n.id,name:n.name,part_number:n.part_number,location:n.location,cost:n.cost,status:n.status}))}),setTimeout(()=>{j(!1)},500)}a()},[b]);const h=s.parts.find(a=>a.status=="Parts Not Available"||a.status=="Not Available - On Order")!==void 0;async function A(a){if(a.preventDefault(),h){const t=await p({...s,user:u,status:"AVAILABILITY"});c(m(t.status)),x.visit("#availability")}else if(l.warranty_status=="OOW"){const t=await p({...s,user:u,status:"AVAILABILITY"});c(m(t.status)),x.visit("#availability")}else{const t=await p({...s,user:u,status:"REPLACEMENT PARTS"});c(m(t.status)),x.visit("#replacement_parts")}}function i(a,t,n){const v=[...s.parts];v[n][t]=a,r({...s,parts:v})}function w(){r({...s,parts:[...s.parts,{name:null,part_number:null,location:null,cost:null,status:"Parts Available"}]})}function _(a){const t=[...s.parts];t.splice(a,1),r({...s,parts:t})}return e.jsx("form",{onSubmit:A,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[l.warranty_status=="IW"?e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",className:"flex items-center rounded-md mt-3 bg-white px-2.5 py-1.5 text-sm text-green-500 font-semibold shadow-sm ring-1 ring-inset ring-green-500",children:[e.jsx(g,{className:"h-5"}),e.jsx("span",{children:"IN WARRANTY"})]}),e.jsx("i",{"aria-hidden":"true",className:"v-icon notranslate v-icon--left mdi mdi-list-status theme--light"})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",className:"flex items-center rounded-md mt-3 bg-white px-2.5 py-1.5 text-sm text-blue-500 font-semibold shadow-sm ring-1 ring-inset ring-blue-500",children:[e.jsx(g,{className:"h-5"}),e.jsx("span",{children:"OUT OF WARRANTY"})]}),e.jsx("i",{"aria-hidden":"true",className:"v-icon notranslate v-icon--left mdi mdi-list-status theme--light"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-2xl",children:"Availability"}),e.jsx("button",{onClick:w,className:"p-3 bg-blue-600 hover:bg-blue-700 rounded-md text-white",children:"ADD ROW"})]}),!b&&s.parts.map((a,t)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"name",t),name:"name",span:"",required:!0,value:a.name??"",label:"Name",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"part_number",t),name:"part_number",span:"",required:!0,value:a.part_number??"",label:"Part Number",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"location",t),name:"location",span:"",required:!0,value:a.location??"",label:"Location",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"cost",t),name:"cost",span:"",required:!0,value:a.cost??"",label:"Cost",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(O,{ids:t,onChange:i,name:"status",required:!1,value:a.status??null,label:"status",errorMessage:"",data:[{value:"Parts Available",name:"Parts Available"},{value:"Parts Not Available",name:"Parts Not Available"},{value:"Not Available - On Order",name:"Not Available - On Order"}]})}),e.jsx("button",{className:"border border-red-500 rounded-md flex-none text-red-500 p-2.5",onClick:()=>_(t),children:e.jsx(I,{className:"h-6"})})]},t)),e.jsx("div",{children:e.jsx(o,{onChange:a=>r({...s,internal_notes:a}),name:"internal_notes",span:"",required:!1,value:(s==null?void 0:s.internal_notes)??"",label:"Internal Notes",type:"text"})}),l.warranty_status=="OOW"?e.jsx("button",{className:"p-3 rounded-md bg-green-500 hover:bg-green-600 text-white w-96",children:"PROCEED"}):h?e.jsx("button",{className:"p-3 rounded-md bg-green-500 hover:bg-green-600 text-white w-96",children:"PROCEED"}):e.jsx("button",{className:"p-3 rounded-md bg-green-500 hover:bg-green-600 text-white w-96",children:"MOVE TO REPLACEMENT"})]})})}export{k as default};
