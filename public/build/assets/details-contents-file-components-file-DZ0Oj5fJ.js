import{r as a,G as ge,q as ft,j as ie,s as Ve}from"./page-DqzE0-nr.js";import{u as mt}from"./app-CX1TwfNA.js";import{b as vt,d as gt}from"./customer-tickets-thunk-DBBMfTU6.js";import{h as ke}from"./page-B6ffQ_89.js";import{s as pt}from"./index-Cmx3rRen.js";import{U as ht}from"./index-DVRaT1oz.js";import{R as wt}from"./EyeOutlined-DU4AkV_f.js";import{I as xe,e as q,h as ne,k as ae,x as Ct,_ as T,s as z,aa as St,A as bt,q as be,z as xt,d as Qe,g as It,m as We,T as pe,ab as yt,u as Je,a as et,l as Fe}from"./asyncToGenerator-BcfSbg8Z.js";import{g as tt,a as Ce,b as Rt}from"./addEventListener-DfoNCfBT.js";import{P as Mt,u as $e}from"./index-C4QAArOu.js";import{D as Pt,g as Et,i as Ot}from"./index-BiAHakXL.js";import{K as ze}from"./KeyCode-DNlgD2sM.js";import{u as ot,a as nt}from"./useZIndex-DLsQrGnX.js";import{g as Oe}from"./motion-4S5rSXvC.js";import{R as Tt}from"./pickAttrs-CytUKMFb.js";import{a as Nt,R as _t}from"./RightOutlined-DouamT1I.js";import{i as Lt}from"./zoom-DSxnsLhx.js";import"./index-DYM8TcfK.js";import"./tickets-service-CkLH7Spu.js";import"./files-service-in3ciA8f.js";import"./render-BS0NmNht.js";import"./InfoCircleFilled-DE-IPfkE.js";import"./index-CcHIY6N-.js";import"./ContextIsolator-DkS6tMeV.js";import"./compact-item-BAW5xiWx.js";import"./roundedArrow-YoMvkauD.js";import"./button-N2zNdCUr.js";import"./useForceUpdate-DPpXG2eu.js";import"./DeleteOutlined-BD0K_h6I.js";import"./useLocale-B3iS6PRM.js";var kt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},$t=function(e,o){return a.createElement(xe,q({},e,{ref:o,icon:kt}))},zt=a.forwardRef($t),jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z"}},{tag:"path",attrs:{d:"M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z"}}]},name:"rotate-left",theme:"outlined"},At=function(e,o){return a.createElement(xe,q({},e,{ref:o,icon:jt}))},Dt=a.forwardRef(At),Yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z"}},{tag:"path",attrs:{d:"M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z"}}]},name:"rotate-right",theme:"outlined"},Xt=function(e,o){return a.createElement(xe,q({},e,{ref:o,icon:Yt}))},Zt=a.forwardRef(Xt),Ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"swap",theme:"outlined"},Bt=function(e,o){return a.createElement(xe,q({},e,{ref:o,icon:Ht}))},Ue=a.forwardRef(Bt),Vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-in",theme:"outlined"},Wt=function(e,o){return a.createElement(xe,q({},e,{ref:o,icon:Vt}))},Ft=a.forwardRef(Wt),Ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-out",theme:"outlined"},Gt=function(e,o){return a.createElement(xe,q({},e,{ref:o,icon:Ut}))},qt=a.forwardRef(Gt),ye=a.createContext(null),Kt=function(e){var o=e.visible,n=e.maskTransitionName,r=e.getContainer,i=e.prefixCls,f=e.rootClassName,l=e.icons,d=e.countRender,m=e.showSwitch,p=e.showProgress,c=e.current,y=e.transform,C=e.count,h=e.scale,R=e.minScale,P=e.maxScale,S=e.closeIcon,N=e.onSwitchLeft,u=e.onSwitchRight,w=e.onClose,s=e.onZoomIn,b=e.onZoomOut,v=e.onRotateRight,g=e.onRotateLeft,I=e.onFlipX,M=e.onFlipY,x=e.onReset,O=e.toolbarRender,$=e.zIndex,L=e.image,j=a.useContext(ye),H=l.rotateLeft,B=l.rotateRight,V=l.zoomIn,D=l.zoomOut,W=l.close,K=l.left,Q=l.right,F=l.flipX,se=l.flipY,le="".concat(i,"-operations-operation");a.useEffect(function(){var _=function(Y){Y.keyCode===ze.ESC&&w()};return o&&window.addEventListener("keydown",_),function(){window.removeEventListener("keydown",_)}},[o]);var J=[{icon:se,onClick:M,type:"flipY"},{icon:F,onClick:I,type:"flipX"},{icon:H,onClick:g,type:"rotateLeft"},{icon:B,onClick:v,type:"rotateRight"},{icon:D,onClick:b,type:"zoomOut",disabled:h<=R},{icon:V,onClick:s,type:"zoomIn",disabled:h===P}],A=J.map(function(_){var E,Y=_.icon,X=_.onClick,U=_.type,re=_.disabled;return a.createElement("div",{className:ne(le,(E={},ae(E,"".concat(i,"-operations-operation-").concat(U),!0),ae(E,"".concat(i,"-operations-operation-disabled"),!!re),E)),onClick:X,key:U},Y)}),Z=a.createElement("div",{className:"".concat(i,"-operations")},A);return a.createElement(Ct,{visible:o,motionName:n},function(_){var E=_.className,Y=_.style;return a.createElement(Mt,{open:!0,getContainer:r??document.body},a.createElement("div",{className:ne("".concat(i,"-operations-wrapper"),E,f),style:T(T({},Y),{},{zIndex:$})},S===null?null:a.createElement("button",{className:"".concat(i,"-close"),onClick:w},S||W),m&&a.createElement(a.Fragment,null,a.createElement("div",{className:ne("".concat(i,"-switch-left"),ae({},"".concat(i,"-switch-left-disabled"),c===0)),onClick:N},K),a.createElement("div",{className:ne("".concat(i,"-switch-right"),ae({},"".concat(i,"-switch-right-disabled"),c===C-1)),onClick:u},Q)),a.createElement("div",{className:"".concat(i,"-footer")},p&&a.createElement("div",{className:"".concat(i,"-progress")},d?d(c+1,C):"".concat(c+1," / ").concat(C)),O?O(Z,T(T({icons:{flipYIcon:A[0],flipXIcon:A[1],rotateLeftIcon:A[2],rotateRightIcon:A[3],zoomOutIcon:A[4],zoomInIcon:A[5]},actions:{onFlipY:M,onFlipX:I,onRotateLeft:g,onRotateRight:v,onZoomOut:b,onZoomIn:s,onReset:x,onClose:w},transform:y},j?{current:c,total:C}:{}),{},{image:L})):Z)))})},Ee={x:0,y:0,rotate:0,scale:1,flipX:!1,flipY:!1};function Qt(t,e,o,n){var r=a.useRef(null),i=a.useRef([]),f=a.useState(Ee),l=z(f,2),d=l[0],m=l[1],p=function(h){m(Ee),St(Ee,d)||n==null||n({transform:Ee,action:h})},c=function(h,R){r.current===null&&(i.current=[],r.current=bt(function(){m(function(P){var S=P;return i.current.forEach(function(N){S=T(T({},S),N)}),r.current=null,n==null||n({transform:S,action:R}),S})})),i.current.push(T(T({},d),h))},y=function(h,R,P,S,N){var u=t.current,w=u.width,s=u.height,b=u.offsetWidth,v=u.offsetHeight,g=u.offsetLeft,I=u.offsetTop,M=h,x=d.scale*h;x>o?(x=o,M=o/d.scale):x<e&&(x=N?x:e,M=x/d.scale);var O=P??innerWidth/2,$=S??innerHeight/2,L=M-1,j=L*w*.5,H=L*s*.5,B=L*(O-d.x-g),V=L*($-d.y-I),D=d.x-(B-j),W=d.y-(V-H);if(h<1&&x===1){var K=b*x,Q=v*x,F=tt(),se=F.width,le=F.height;K<=se&&Q<=le&&(D=0,W=0)}c({x:D,y:W,scale:x},R)};return{transform:d,resetTransform:p,updateTransform:c,dispatchZoomChange:y}}function Ge(t,e,o,n){var r=e+o,i=(o-n)/2;if(o>n){if(e>0)return ae({},t,i);if(e<0&&r<n)return ae({},t,-i)}else if(e<0||r>n)return ae({},t,e<0?i:-i);return{}}function at(t,e,o,n){var r=tt(),i=r.width,f=r.height,l=null;return t<=i&&e<=f?l={x:0,y:0}:(t>i||e>f)&&(l=T(T({},Ge("x",o,t,i)),Ge("y",n,e,f))),l}var Se=1,Jt=1;function eo(t,e,o,n,r,i,f){var l=r.rotate,d=r.scale,m=r.x,p=r.y,c=a.useState(!1),y=z(c,2),C=y[0],h=y[1],R=a.useRef({diffX:0,diffY:0,transformX:0,transformY:0}),P=function(s){!e||s.button!==0||(s.preventDefault(),s.stopPropagation(),R.current={diffX:s.pageX-m,diffY:s.pageY-p,transformX:m,transformY:p},h(!0))},S=function(s){o&&C&&i({x:s.pageX-R.current.diffX,y:s.pageY-R.current.diffY},"move")},N=function(){if(o&&C){h(!1);var s=R.current,b=s.transformX,v=s.transformY,g=m!==b&&p!==v;if(!g)return;var I=t.current.offsetWidth*d,M=t.current.offsetHeight*d,x=t.current.getBoundingClientRect(),O=x.left,$=x.top,L=l%180!==0,j=at(L?M:I,L?I:M,O,$);j&&i(T({},j),"dragRebound")}},u=function(s){if(!(!o||s.deltaY==0)){var b=Math.abs(s.deltaY/100),v=Math.min(b,Jt),g=Se+v*n;s.deltaY>0&&(g=Se/g),f(g,"wheel",s.clientX,s.clientY)}};return a.useEffect(function(){var w,s,b,v;if(e){b=Ce(window,"mouseup",N,!1),v=Ce(window,"mousemove",S,!1);try{window.top!==window.self&&(w=Ce(window.top,"mouseup",N,!1),s=Ce(window.top,"mousemove",S,!1))}catch{}}return function(){var g,I,M,x;(g=b)===null||g===void 0||g.remove(),(I=v)===null||I===void 0||I.remove(),(M=w)===null||M===void 0||M.remove(),(x=s)===null||x===void 0||x.remove()}},[o,C,m,p,l,e]),{isMoving:C,onMouseDown:P,onMouseMove:S,onMouseUp:N,onWheel:u}}function to(t){return new Promise(function(e){var o=document.createElement("img");o.onerror=function(){return e(!1)},o.onload=function(){return e(!0)},o.src=t})}function rt(t){var e=t.src,o=t.isCustomPlaceholder,n=t.fallback,r=a.useState(o?"loading":"normal"),i=z(r,2),f=i[0],l=i[1],d=a.useRef(!1),m=f==="error";a.useEffect(function(){var C=!0;return to(e).then(function(h){!h&&C&&l("error")}),function(){C=!1}},[e]),a.useEffect(function(){o&&!d.current?l("loading"):m&&l("normal")},[e]);var p=function(){l("normal")},c=function(h){d.current=!1,f==="loading"&&h!==null&&h!==void 0&&h.complete&&(h.naturalWidth||h.naturalHeight)&&(d.current=!0,p())},y=m&&n?{src:n}:{onLoad:p,src:e};return[c,y,f]}function Te(t,e){var o=t.x-e.x,n=t.y-e.y;return Math.hypot(o,n)}function oo(t,e,o,n){var r=Te(t,o),i=Te(e,n);if(r===0&&i===0)return[t.x,t.y];var f=r/(r+i),l=t.x+f*(e.x-t.x),d=t.y+f*(e.y-t.y);return[l,d]}function no(t,e,o,n,r,i,f){var l=r.rotate,d=r.scale,m=r.x,p=r.y,c=a.useState(!1),y=z(c,2),C=y[0],h=y[1],R=a.useRef({point1:{x:0,y:0},point2:{x:0,y:0},eventType:"none"}),P=function(s){R.current=T(T({},R.current),s)},S=function(s){if(e){s.stopPropagation(),h(!0);var b=s.touches,v=b===void 0?[]:b;v.length>1?P({point1:{x:v[0].clientX,y:v[0].clientY},point2:{x:v[1].clientX,y:v[1].clientY},eventType:"touchZoom"}):P({point1:{x:v[0].clientX-m,y:v[0].clientY-p},eventType:"move"})}},N=function(s){var b=s.touches,v=b===void 0?[]:b,g=R.current,I=g.point1,M=g.point2,x=g.eventType;if(v.length>1&&x==="touchZoom"){var O={x:v[0].clientX,y:v[0].clientY},$={x:v[1].clientX,y:v[1].clientY},L=oo(I,M,O,$),j=z(L,2),H=j[0],B=j[1],V=Te(O,$)/Te(I,M);f(V,"touchZoom",H,B,!0),P({point1:O,point2:$,eventType:"touchZoom"})}else x==="move"&&(i({x:v[0].clientX-I.x,y:v[0].clientY-I.y},"move"),P({eventType:"move"}))},u=function(){if(o){if(C&&h(!1),P({eventType:"none"}),n>d)return i({x:0,y:0,scale:n},"touchZoom");var s=t.current.offsetWidth*d,b=t.current.offsetHeight*d,v=t.current.getBoundingClientRect(),g=v.left,I=v.top,M=l%180!==0,x=at(M?b:s,M?s:b,g,I);x&&i(T({},x),"dragRebound")}};return a.useEffect(function(){var w;return o&&e&&(w=Ce(window,"touchmove",function(s){return s.preventDefault()},{passive:!1})),function(){var s;(s=w)===null||s===void 0||s.remove()}},[o,e]),{isTouching:C,onTouchStart:S,onTouchMove:N,onTouchEnd:u}}var ao=["fallback","src","imgRef"],ro=["prefixCls","src","alt","imageInfo","fallback","movable","onClose","visible","icons","rootClassName","closeIcon","getContainer","current","count","countRender","scaleStep","minScale","maxScale","transitionName","maskTransitionName","imageRender","imgCommonProps","toolbarRender","onTransform","onChange"],io=function(e){var o=e.fallback,n=e.src,r=e.imgRef,i=be(e,ao),f=rt({src:n,fallback:o}),l=z(f,2),d=l[0],m=l[1];return ge.createElement("img",q({ref:function(c){r.current=c,d(c)}},i,m))},it=function(e){var o=e.prefixCls,n=e.src,r=e.alt,i=e.imageInfo,f=e.fallback,l=e.movable,d=l===void 0?!0:l,m=e.onClose,p=e.visible,c=e.icons,y=c===void 0?{}:c,C=e.rootClassName,h=e.closeIcon,R=e.getContainer,P=e.current,S=P===void 0?0:P,N=e.count,u=N===void 0?1:N,w=e.countRender,s=e.scaleStep,b=s===void 0?.5:s,v=e.minScale,g=v===void 0?1:v,I=e.maxScale,M=I===void 0?50:I,x=e.transitionName,O=x===void 0?"zoom":x,$=e.maskTransitionName,L=$===void 0?"fade":$,j=e.imageRender,H=e.imgCommonProps,B=e.toolbarRender,V=e.onTransform,D=e.onChange,W=be(e,ro),K=a.useRef(),Q=a.useContext(ye),F=Q&&u>1,se=Q&&u>=1,le=a.useState(!0),J=z(le,2),A=J[0],Z=J[1],_=Qt(K,g,M,V),E=_.transform,Y=_.resetTransform,X=_.updateTransform,U=_.dispatchZoomChange,re=eo(K,d,p,b,E,X,U),he=re.isMoving,Ie=re.onMouseDown,we=re.onWheel,ee=no(K,d,p,g,E,X,U),te=ee.isTouching,oe=ee.onTouchStart,de=ee.onTouchMove,ve=ee.onTouchEnd,ce=E.rotate,ue=E.scale,Ne=ne(ae({},"".concat(o,"-moving"),he));a.useEffect(function(){A||Z(!0)},[A]);var _e=function(){Y("close")},Le=function(){U(Se+b,"zoomIn")},fe=function(){U(Se/(Se+b),"zoomOut")},me=function(){X({rotate:ce+90},"rotateRight")},Re=function(){X({rotate:ce-90},"rotateLeft")},Me=function(){X({flipX:!E.flipX},"flipX")},Pe=function(){X({flipY:!E.flipY},"flipY")},ct=function(){Y("reset")},Xe=function(k){k==null||k.preventDefault(),k==null||k.stopPropagation(),S>0&&(Z(!1),Y("prev"),D==null||D(S-1,S))},Ze=function(k){k==null||k.preventDefault(),k==null||k.stopPropagation(),S<u-1&&(Z(!1),Y("next"),D==null||D(S+1,S))},ut=function(k){!p||!F||(k.keyCode===ze.LEFT?Xe():k.keyCode===ze.RIGHT&&Ze())},dt=function(k){p&&(ue!==1?X({x:0,y:0,scale:1},"doubleClick"):U(Se+b,"doubleClick",k.clientX,k.clientY))};a.useEffect(function(){var G=Ce(window,"keydown",ut,!1);return function(){G.remove()}},[p,F,S]);var He=ge.createElement(io,q({},H,{width:e.width,height:e.height,imgRef:K,className:"".concat(o,"-img"),alt:r,style:{transform:"translate3d(".concat(E.x,"px, ").concat(E.y,"px, 0) scale3d(").concat(E.flipX?"-":"").concat(ue,", ").concat(E.flipY?"-":"").concat(ue,", 1) rotate(").concat(ce,"deg)"),transitionDuration:(!A||te)&&"0s"},fallback:f,src:n,onWheel:we,onMouseDown:Ie,onDoubleClick:dt,onTouchStart:oe,onTouchMove:de,onTouchEnd:ve,onTouchCancel:ve})),Be=T({url:n,alt:r},i);return ge.createElement(ge.Fragment,null,ge.createElement(Pt,q({transitionName:O,maskTransitionName:L,closable:!1,keyboard:!0,prefixCls:o,onClose:m,visible:p,classNames:{wrapper:Ne},rootClassName:C,getContainer:R},W,{afterClose:_e}),ge.createElement("div",{className:"".concat(o,"-img-wrapper")},j?j(He,T({transform:E,image:Be},Q?{current:S}:{})):He)),ge.createElement(Kt,{visible:p,transform:E,maskTransitionName:L,closeIcon:h,getContainer:R,prefixCls:o,rootClassName:C,icons:y,countRender:w,showSwitch:F,showProgress:se,current:S,count:u,scale:ue,minScale:g,maxScale:M,toolbarRender:B,onSwitchLeft:Xe,onSwitchRight:Ze,onZoomIn:Le,onZoomOut:fe,onRotateRight:me,onRotateLeft:Re,onFlipX:Me,onFlipY:Pe,onClose:m,onReset:ct,zIndex:W.zIndex!==void 0?W.zIndex+1:void 0,image:Be}))},je=["crossOrigin","decoding","draggable","loading","referrerPolicy","sizes","srcSet","useMap","alt"];function so(t){var e=a.useState({}),o=z(e,2),n=o[0],r=o[1],i=a.useCallback(function(l,d){return r(function(m){return T(T({},m),{},ae({},l,d))}),function(){r(function(m){var p=T({},m);return delete p[l],p})}},[]),f=a.useMemo(function(){return t?t.map(function(l){if(typeof l=="string")return{data:{src:l}};var d={};return Object.keys(l).forEach(function(m){["src"].concat(xt(je)).includes(m)&&(d[m]=l[m])}),{data:d}}):Object.keys(n).reduce(function(l,d){var m=n[d],p=m.canPreview,c=m.data;return p&&l.push({data:c,id:d}),l},[])},[t,n]);return[f,i,!!t]}var lo=["visible","onVisibleChange","getContainer","current","movable","minScale","maxScale","countRender","closeIcon","onChange","onTransform","toolbarRender","imageRender"],co=["src"],uo=function(e){var o,n=e.previewPrefixCls,r=n===void 0?"rc-image-preview":n,i=e.children,f=e.icons,l=f===void 0?{}:f,d=e.items,m=e.preview,p=e.fallback,c=Qe(m)==="object"?m:{},y=c.visible,C=c.onVisibleChange,h=c.getContainer,R=c.current,P=c.movable,S=c.minScale,N=c.maxScale,u=c.countRender,w=c.closeIcon,s=c.onChange,b=c.onTransform,v=c.toolbarRender,g=c.imageRender,I=be(c,lo),M=so(d),x=z(M,3),O=x[0],$=x[1],L=x[2],j=$e(0,{value:R}),H=z(j,2),B=H[0],V=H[1],D=a.useState(!1),W=z(D,2),K=W[0],Q=W[1],F=((o=O[B])===null||o===void 0?void 0:o.data)||{},se=F.src,le=be(F,co),J=$e(!!y,{value:y,onChange:function(te,oe){C==null||C(te,oe,B)}}),A=z(J,2),Z=A[0],_=A[1],E=a.useState(null),Y=z(E,2),X=Y[0],U=Y[1],re=a.useCallback(function(ee,te,oe,de){var ve=L?O.findIndex(function(ce){return ce.data.src===te}):O.findIndex(function(ce){return ce.id===ee});V(ve<0?0:ve),_(!0),U({x:oe,y:de}),Q(!0)},[O,L]);a.useEffect(function(){Z?K||V(0):Q(!1)},[Z]);var he=function(te,oe){V(te),s==null||s(te,oe)},Ie=function(){_(!1),U(null)},we=a.useMemo(function(){return{register:$,onPreview:re}},[$,re]);return a.createElement(ye.Provider,{value:we},i,a.createElement(it,q({"aria-hidden":!Z,movable:P,visible:Z,prefixCls:r,closeIcon:w,onClose:Ie,mousePosition:X,imgCommonProps:le,src:se,fallback:p,icons:l,minScale:S,maxScale:N,getContainer:h,current:B,count:O.length,countRender:u,onTransform:b,toolbarRender:v,imageRender:g,onChange:he},I)))},qe=0;function fo(t,e){var o=a.useState(function(){return qe+=1,String(qe)}),n=z(o,1),r=n[0],i=a.useContext(ye),f={data:e,canPreview:t};return a.useEffect(function(){if(i)return i.register(r,f)},[]),a.useEffect(function(){i&&i.register(r,f)},[t,e]),r}var mo=["src","alt","onPreviewClose","prefixCls","previewPrefixCls","placeholder","fallback","width","height","style","preview","className","onClick","onError","wrapperClassName","wrapperStyle","rootClassName"],vo=["src","visible","onVisibleChange","getContainer","mask","maskClassName","movable","icons","scaleStep","minScale","maxScale","imageRender","toolbarRender"],Ye=function(e){var o=e.src,n=e.alt,r=e.onPreviewClose,i=e.prefixCls,f=i===void 0?"rc-image":i,l=e.previewPrefixCls,d=l===void 0?"".concat(f,"-preview"):l,m=e.placeholder,p=e.fallback,c=e.width,y=e.height,C=e.style,h=e.preview,R=h===void 0?!0:h,P=e.className,S=e.onClick,N=e.onError,u=e.wrapperClassName,w=e.wrapperStyle,s=e.rootClassName,b=be(e,mo),v=m&&m!==!0,g=Qe(R)==="object"?R:{},I=g.src,M=g.visible,x=M===void 0?void 0:M,O=g.onVisibleChange,$=O===void 0?r:O,L=g.getContainer,j=L===void 0?void 0:L,H=g.mask,B=g.maskClassName,V=g.movable,D=g.icons,W=g.scaleStep,K=g.minScale,Q=g.maxScale,F=g.imageRender,se=g.toolbarRender,le=be(g,vo),J=I??o,A=$e(!!x,{value:x,onChange:$}),Z=z(A,2),_=Z[0],E=Z[1],Y=rt({src:o,isCustomPlaceholder:v,fallback:p}),X=z(Y,3),U=X[0],re=X[1],he=X[2],Ie=a.useState(null),we=z(Ie,2),ee=we[0],te=we[1],oe=a.useContext(ye),de=!!R,ve=function(){E(!1),te(null)},ce=ne(f,u,s,ae({},"".concat(f,"-error"),he==="error")),ue=a.useMemo(function(){var fe={};return je.forEach(function(me){e[me]!==void 0&&(fe[me]=e[me])}),fe},je.map(function(fe){return e[fe]})),Ne=a.useMemo(function(){return T(T({},ue),{},{src:J})},[J,ue]),_e=fo(de,Ne),Le=function(me){var Re=Rt(me.target),Me=Re.left,Pe=Re.top;oe?oe.onPreview(_e,J,Me,Pe):(te({x:Me,y:Pe}),E(!0)),S==null||S(me)};return a.createElement(a.Fragment,null,a.createElement("div",q({},b,{className:ce,onClick:de?Le:S,style:T({width:c,height:y},w)}),a.createElement("img",q({},ue,{className:ne("".concat(f,"-img"),ae({},"".concat(f,"-img-placeholder"),m===!0),P),style:T({height:y},C),ref:U},re,{width:c,height:y,onError:N})),he==="loading"&&a.createElement("div",{"aria-hidden":"true",className:"".concat(f,"-placeholder")},m),H&&de&&a.createElement("div",{className:ne("".concat(f,"-mask"),B),style:{display:(C==null?void 0:C.display)==="none"?"none":void 0}},H)),!oe&&de&&a.createElement(it,q({"aria-hidden":!_,visible:_,prefixCls:d,onClose:ve,mousePosition:ee,src:J,alt:n,imageInfo:{width:c,height:y},fallback:p,getContainer:j,icons:D,movable:V,scaleStep:W,minScale:K,maxScale:Q,rootClassName:s,imageRender:F,imgCommonProps:ue,toolbarRender:se},le)))};Ye.PreviewGroup=uo;const Ae=t=>({position:t||"absolute",inset:0}),go=t=>{const{iconCls:e,motionDurationSlow:o,paddingXXS:n,marginXXS:r,prefixCls:i,colorTextLightSolid:f}=t;return{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:f,background:new pe("#000").setAlpha(.5).toRgbString(),cursor:"pointer",opacity:0,transition:`opacity ${o}`,[`.${i}-mask-info`]:Object.assign(Object.assign({},yt),{padding:`0 ${Je(n)}`,[e]:{marginInlineEnd:r,svg:{verticalAlign:"baseline"}}})}},po=t=>{const{previewCls:e,modalMaskBg:o,paddingSM:n,marginXL:r,margin:i,paddingLG:f,previewOperationColorDisabled:l,previewOperationHoverColor:d,motionDurationSlow:m,iconCls:p,colorTextLightSolid:c}=t,y=new pe(o).setAlpha(.1),C=y.clone().setAlpha(.2);return{[`${e}-footer`]:{position:"fixed",bottom:r,left:{_skip_check_:!0,value:"50%"},display:"flex",flexDirection:"column",alignItems:"center",color:t.previewOperationColor,transform:"translateX(-50%)"},[`${e}-progress`]:{marginBottom:i},[`${e}-close`]:{position:"fixed",top:r,right:{_skip_check_:!0,value:r},display:"flex",color:c,backgroundColor:y.toRgbString(),borderRadius:"50%",padding:n,outline:0,border:0,cursor:"pointer",transition:`all ${m}`,"&:hover":{backgroundColor:C.toRgbString()},[`& > ${p}`]:{fontSize:t.previewOperationSize}},[`${e}-operations`]:{display:"flex",alignItems:"center",padding:`0 ${Je(f)}`,backgroundColor:y.toRgbString(),borderRadius:100,"&-operation":{marginInlineStart:n,padding:n,cursor:"pointer",transition:`all ${m}`,userSelect:"none",[`&:not(${e}-operations-operation-disabled):hover > ${p}`]:{color:d},"&-disabled":{color:l,cursor:"not-allowed"},"&:first-of-type":{marginInlineStart:0},[`& > ${p}`]:{fontSize:t.previewOperationSize}}}}},ho=t=>{const{modalMaskBg:e,iconCls:o,previewOperationColorDisabled:n,previewCls:r,zIndexPopup:i,motionDurationSlow:f}=t,l=new pe(e).setAlpha(.1),d=l.clone().setAlpha(.2);return{[`${r}-switch-left, ${r}-switch-right`]:{position:"fixed",insetBlockStart:"50%",zIndex:t.calc(i).add(1).equal(),display:"flex",alignItems:"center",justifyContent:"center",width:t.imagePreviewSwitchSize,height:t.imagePreviewSwitchSize,marginTop:t.calc(t.imagePreviewSwitchSize).mul(-1).div(2).equal(),color:t.previewOperationColor,background:l.toRgbString(),borderRadius:"50%",transform:"translateY(-50%)",cursor:"pointer",transition:`all ${f}`,userSelect:"none","&:hover":{background:d.toRgbString()},"&-disabled":{"&, &:hover":{color:n,background:"transparent",cursor:"not-allowed",[`> ${o}`]:{cursor:"not-allowed"}}},[`> ${o}`]:{fontSize:t.previewOperationSize}},[`${r}-switch-left`]:{insetInlineStart:t.marginSM},[`${r}-switch-right`]:{insetInlineEnd:t.marginSM}}},wo=t=>{const{motionEaseOut:e,previewCls:o,motionDurationSlow:n,componentCls:r}=t;return[{[`${r}-preview-root`]:{[o]:{height:"100%",textAlign:"center",pointerEvents:"none"},[`${o}-body`]:Object.assign(Object.assign({},Ae()),{overflow:"hidden"}),[`${o}-img`]:{maxWidth:"100%",maxHeight:"70%",verticalAlign:"middle",transform:"scale3d(1, 1, 1)",cursor:"grab",transition:`transform ${n} ${e} 0s`,userSelect:"none","&-wrapper":Object.assign(Object.assign({},Ae()),{transition:`transform ${n} ${e} 0s`,display:"flex",justifyContent:"center",alignItems:"center","& > *":{pointerEvents:"auto"},"&::before":{display:"inline-block",width:1,height:"50%",marginInlineEnd:-1,content:'""'}})},[`${o}-moving`]:{[`${o}-preview-img`]:{cursor:"grabbing","&-wrapper":{transitionDuration:"0s"}}}}},{[`${r}-preview-root`]:{[`${o}-wrap`]:{zIndex:t.zIndexPopup}}},{[`${r}-preview-operations-wrapper`]:{position:"fixed",zIndex:t.calc(t.zIndexPopup).add(1).equal()},"&":[po(t),ho(t)]}]},Co=t=>{const{componentCls:e}=t;return{[e]:{position:"relative",display:"inline-block",[`${e}-img`]:{width:"100%",height:"auto",verticalAlign:"middle"},[`${e}-img-placeholder`]:{backgroundColor:t.colorBgContainerDisabled,backgroundImage:"url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTQuNSAyLjVoLTEzQS41LjUgMCAwIDAgMSAzdjEwYS41LjUgMCAwIDAgLjUuNWgxM2EuNS41IDAgMCAwIC41LS41VjNhLjUuNSAwIDAgMC0uNS0uNXpNNS4yODEgNC43NWExIDEgMCAwIDEgMCAyIDEgMSAwIDAgMSAwLTJ6bTguMDMgNi44M2EuMTI3LjEyNyAwIDAgMS0uMDgxLjAzSDIuNzY5YS4xMjUuMTI1IDAgMCAxLS4wOTYtLjIwN2wyLjY2MS0zLjE1NmEuMTI2LjEyNiAwIDAgMSAuMTc3LS4wMTZsLjAxNi4wMTZMNy4wOCAxMC4wOWwyLjQ3LTIuOTNhLjEyNi4xMjYgMCAwIDEgLjE3Ny0uMDE2bC4wMTUuMDE2IDMuNTg4IDQuMjQ0YS4xMjcuMTI3IDAgMCAxLS4wMi4xNzV6IiBmaWxsPSIjOEM4QzhDIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L3N2Zz4=')",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"30%"},[`${e}-mask`]:Object.assign({},go(t)),[`${e}-mask:hover`]:{opacity:1},[`${e}-placeholder`]:Object.assign({},Ae())}}},So=t=>{const{previewCls:e}=t;return{[`${e}-root`]:Lt(t,"zoom"),"&":Ot(t,!0)}},bo=t=>({zIndexPopup:t.zIndexPopupBase+80,previewOperationColor:new pe(t.colorTextLightSolid).setAlpha(.65).toRgbString(),previewOperationHoverColor:new pe(t.colorTextLightSolid).setAlpha(.85).toRgbString(),previewOperationColorDisabled:new pe(t.colorTextLightSolid).setAlpha(.25).toRgbString(),previewOperationSize:t.fontSizeIcon*1.5}),st=It("Image",t=>{const e=`${t.componentCls}-preview`,o=We(t,{previewCls:e,modalMaskBg:new pe("#000").setAlpha(.45).toRgbString(),imagePreviewSwitchSize:t.controlHeightLG});return[Co(o),wo(o),Et(We(o,{componentCls:e})),So(o)]},bo);var xo=function(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(o[n[r]]=t[n[r]]);return o};const lt={rotateLeft:a.createElement(Dt,null),rotateRight:a.createElement(Zt,null),zoomIn:a.createElement(Ft,null),zoomOut:a.createElement(qt,null),close:a.createElement(Tt,null),left:a.createElement(Nt,null),right:a.createElement(_t,null),flipX:a.createElement(Ue,null),flipY:a.createElement(Ue,{rotate:90})},Io=t=>{var{previewPrefixCls:e,preview:o}=t,n=xo(t,["previewPrefixCls","preview"]);const{getPrefixCls:r}=a.useContext(et),i=r("image",e),f=`${i}-preview`,l=r(),d=ot(i),[m,p,c]=st(i,d),[y]=nt("ImagePreview",typeof o=="object"?o.zIndex:void 0),C=a.useMemo(()=>{var h;if(o===!1)return o;const R=typeof o=="object"?o:{},P=ne(p,c,d,(h=R.rootClassName)!==null&&h!==void 0?h:"");return Object.assign(Object.assign({},R),{transitionName:Oe(l,"zoom",R.transitionName),maskTransitionName:Oe(l,"fade",R.maskTransitionName),rootClassName:P,zIndex:y})},[o]);return m(a.createElement(Ye.PreviewGroup,Object.assign({preview:C,previewPrefixCls:f,icons:lt},n)))},yo=Io;var Ke=function(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(o[n[r]]=t[n[r]]);return o};const De=t=>{var e;const{prefixCls:o,preview:n,className:r,rootClassName:i,style:f}=t,l=Ke(t,["prefixCls","preview","className","rootClassName","style"]),{getPrefixCls:d,locale:m=Fe,getPopupContainer:p,image:c}=a.useContext(et),y=d("image",o),C=d(),h=m.Image||Fe.Image,R=ot(y),[P,S,N]=st(y,R),u=ne(i,S,N,R),w=ne(r,S,c==null?void 0:c.className),[s]=nt("ImagePreview",typeof n=="object"?n.zIndex:void 0),b=a.useMemo(()=>{var g;if(n===!1)return n;const I=typeof n=="object"?n:{},{getContainer:M,closeIcon:x}=I,O=Ke(I,["getContainer","closeIcon"]);return Object.assign(Object.assign({mask:a.createElement("div",{className:`${y}-mask-info`},a.createElement(wt,null),h==null?void 0:h.preview),icons:lt},O),{getContainer:M??p,transitionName:Oe(C,"zoom",I.transitionName),maskTransitionName:Oe(C,"fade",I.maskTransitionName),zIndex:s,closeIcon:x??((g=c==null?void 0:c.preview)===null||g===void 0?void 0:g.closeIcon)})},[n,h,(e=c==null?void 0:c.preview)===null||e===void 0?void 0:e.closeIcon]),v=Object.assign(Object.assign({},c==null?void 0:c.style),f);return P(a.createElement(Ye,Object.assign({prefixCls:y,preview:b,rootClassName:u,className:w,style:v},l)))};De.PreviewGroup=yo;const tn=({files:t,type:e})=>{const{user:o}=mt(u=>u.app),{url:n}=ft(),[r,i]=a.useState(!1),[f,l]=a.useState(""),[d,m]=a.useState([]),[p,c]=pt.useMessage(),y="updatable";a.useEffect(()=>{m([...d,...t.map(u=>({uid:u.id,name:ke(u.created_at).format("LLLL"),url:u.url,status:"done",extension:u.url.split("/").pop().split(".").pop()}))])},[]);const C=async u=>{try{if(u.extension=="pdf")window.open(u.url,"_blank");else if(u.extension=="docx"){const w=encodeURIComponent(u.url);window.open(`https://docs.google.com/gview?url=${w}&embedded=true`,"_blank")}else["mp4","webm","ogg","mov"].includes(u.extension)||!u.url&&!u.preview&&(u.preview=await h(u.originFileObj)),window.open(u.url,"_blank")}catch(w){console.error("Error handling file preview:",w)}},h=u=>new Promise((w,s)=>{const b=new FileReader;b.readAsDataURL(u),b.onload=()=>w(b.result),b.onerror=v=>s(v)});function R(u){return!u.some(s=>s.status!=="done")}async function P({fileList:u}){p.open({key:y,type:"loading",content:"Loading..."});const w=new FormData,s=n.split("/")[n.split("/").length-2].split("#")[0],b=s==="tickets"?window.location.pathname.split("/")[3]:s;if(w.append("ticket_id",b),w.append("user_id",o.id),w.append("type",e),R(u)?u.forEach(v=>{v.name!=="uploaded"&&v.status==="done"&&w.append("files[]",v.originFileObj)}):u.forEach(v=>{v.status==="uploading"&&m(u)}),u.length!==0){const v=await Ve.dispatch(vt(w,b));u.forEach(g=>{v.resp.length!==0&&(g.status==="uploading"?m(u):m(v.resp.map(I=>({uid:I.id,name:ke(I.created_at).format("LLLL"),url:I.url,status:"done",extension:I.url.split("/").pop().split(".").pop()}))))})}}const S=ie.jsxs("button",{style:{border:0,background:"none"},type:"button",children:[ie.jsx(zt,{}),ie.jsx("div",{style:{marginTop:8},children:"Upload"})]});async function N(u){if(n.split("/")[n.split("/").length-2].split("#")[0],confirm("Do you want to delete the file?")){const w=await Ve.dispatch(gt(u.uid));m(w.data.map(s=>({uid:s.id,name:ke(s.created_at).format("LLLL"),url:s.url,status:"done",extension:s.url.split("/").pop().split(".").pop()})))}}return ie.jsxs(ie.Fragment,{children:[c,ie.jsxs("div",{class:"px-4 py-3 ",children:[ie.jsx("div",{className:"border border-blue-500 hover:border-blue-600 p-2.5 rounded-md",children:ie.jsx(ht,{multiple:!0,method:"GET",action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",fileList:d,onPreview:C,onChange:P,onRemove:N,children:d.length>=8?null:S})}),f&&d.length!==0&&ie.jsx(De.PreviewGroup,{preview:{visible:r,onVisibleChange:u=>i(u),afterOpenChange:u=>!u&&l("")},children:ie.jsx(De,{wrapperStyle:{display:"none"},src:f})})]})]})};export{tn as default};
