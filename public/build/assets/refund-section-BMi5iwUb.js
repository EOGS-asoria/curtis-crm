import{r as n,c as p,u as R,j as t,O as d,K as M,H as w}from"./app-BVyQeXLY.js";import{I as i}from"./input-BSU_TVFo.js";import{g as E}from"./fedex-rate-service-qYoSmiMQ.js";import{L as C}from"./loading-DJj9XOdu.js";import{g as D}from"./receipt-service-Bmgys-qj.js";import{g as F,s as W}from"./refund-service-CBZ3piz4.js";import{S as q}from"./select-DyCIekCW.js";import{W as $}from"./wysiwyg-D5EGUXqB.js";function U({title:e,titleId:s,...m},c){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":s},m),e?n.createElement("title",{id:s},e):null,n.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 1 1-11-4.69v.447a3.5 3.5 0 0 0 1.025 2.475L8.293 10 8 10.293a1 1 0 0 0 0 1.414l1.06 1.06a1.5 1.5 0 0 1 .44 1.061v.363a1 1 0 0 0 .553.894l.276.139a1 1 0 0 0 1.342-.448l1.454-2.908a1.5 1.5 0 0 0-.281-1.731l-.772-.772a1 1 0 0 0-1.023-.242l-.384.128a.5.5 0 0 1-.606-.25l-.296-.592a.481.481 0 0 1 .646-.646l.262.131a1 1 0 0 0 .447.106h.188a1 1 0 0 0 .949-1.316l-.068-.204a.5.5 0 0 1 .149-.538l1.44-1.234A6.492 6.492 0 0 1 16.5 10Z",clipRule:"evenodd"}))}const O=n.forwardRef(U),L=O;function P({title:e,titleId:s,...m},c){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":s},m),e?n.createElement("title",{id:s},e):null,n.createElement("path",{fillRule:"evenodd",d:"M4.25 2A2.25 2.25 0 0 0 2 4.25v2.5A2.25 2.25 0 0 0 4.25 9h2.5A2.25 2.25 0 0 0 9 6.75v-2.5A2.25 2.25 0 0 0 6.75 2h-2.5Zm0 9A2.25 2.25 0 0 0 2 13.25v2.5A2.25 2.25 0 0 0 4.25 18h2.5A2.25 2.25 0 0 0 9 15.75v-2.5A2.25 2.25 0 0 0 6.75 11h-2.5Zm9-9A2.25 2.25 0 0 0 11 4.25v2.5A2.25 2.25 0 0 0 13.25 9h2.5A2.25 2.25 0 0 0 18 6.75v-2.5A2.25 2.25 0 0 0 15.75 2h-2.5Zm0 9A2.25 2.25 0 0 0 11 13.25v2.5A2.25 2.25 0 0 0 13.25 18h2.5A2.25 2.25 0 0 0 18 15.75v-2.5A2.25 2.25 0 0 0 15.75 11h-2.5Z",clipRule:"evenodd"}))}const T=n.forwardRef(P),G=T;function z(){const{refund:e,ticket:s}=p(a=>a.tickets),{user:m}=p(a=>a.app),[c,x]=n.useState(!1),[A,g]=n.useState(!1),u=R(),{email_templates:b}=p(a=>a.email_templates);n.useEffect(()=>{async function a(){var _,f,y,j;const h=(await D(s.id)).status,l=await F(s.id);u(d({...e,instruction:(l==null?void 0:l.instruction)??" ",shipping_cost:String((l==null?void 0:l.shipping_cost)??0),estimated_cost:String((l==null?void 0:l.estimated_cost)??0),cheque_no:String(((_=s==null?void 0:s.refund)==null?void 0:_.cheque_no)??0),cheque_amount:String(((f=s==null?void 0:s.refund)==null?void 0:f.cheque_amount)??0),mail_date:String(((y=s==null?void 0:s.refund)==null?void 0:y.mail_date)??""),...h,id:s.id,template_text:null,notes:((j=s==null?void 0:s.refund)==null?void 0:j.notes)??" "}))}a()},[s.id]);function r(a,o){o=="wysiwyg"?u(d({...e,template_text:a})):(a||a=="")&&o&&u(d({...e,[o]:a}))}async function N(){x(!0);try{const a=await E(e);u(d({...e,shipping_cost:`${parseFloat(a.rates.FEDEX_GROUND.PAYOR_ACCOUNT_PACKAGE).toFixed(2)}`,estimated_cost:`${(parseFloat(a.rates.FEDEX_GROUND.PAYOR_ACCOUNT_PACKAGE)+parseFloat(e.unit_cost)).toFixed(2)}`}))}catch{alert("No rates Found!")}x(!1)}function S(a){const o=b.find(h=>h.id==a);u(d({...e,template_text:o.template_text}))}async function v(a){a.preventDefault(),g(!0);try{const o=await W({...e,account:m});u(M(o.status)),e.instruction=="US Warehouse"||e.instruction=="CA Warehouse"?w.visit("#files"):w.visit("#refund"),g(!1)}catch{g(!1)}}return t.jsx(t.Fragment,{children:t.jsxs("section",{className:"container border-2 border-slate-400 py-3 bg-white",children:[t.jsx("div",{className:"sm:flex sm:items-center sm:justify-between border-b border-gray-900/10",children:t.jsx("div",{className:"w-full flex justify-center ",children:t.jsx("div",{className:"flex items-center gap-3 mt-4 my-4",children:t.jsx("h1",{className:"text-2xl md:text-3xl pl-2 my-2 border-l-4  font-sans font-bold border-teal-400  ",children:"REFUND"})})})}),t.jsxs("form",{onSubmit:v,className:"flex flex-col gap-6 px-4 ",children:[t.jsxs("div",{className:"flex gap-3 mt-2",children:[t.jsxs("button",{type:"button",className:"flex items-center rounded-md mt-3 bg-white px-2.5 py-1.5 text-sm text-green-500 font-semibold shadow-sm ring-1 ring-inset ring-green-500 hover:bg-green-500 hover:text-gray-500",children:[t.jsx(L,{className:"h-5"}),t.jsx("span",{children:s.country})]}),t.jsxs("button",{type:"button",className:"flex items-center rounded-md mt-3 bg-white px-2.5 py-1.5 text-sm text-yellow-500 font-semibold shadow-sm ring-1 ring-inset ring-yellow-500 hover:bg-yellow-300 hover:text-gray-500",children:[t.jsx(G,{className:"h-5"}),t.jsx("span",{children:s.item_number})]})]}),t.jsxs("div",{className:"flex gap-3 w-full",children:[t.jsx(i,{onChange:r,span:"$",name:"retailers_price",required:!0,value:(e==null?void 0:e.retailers_price)??" ",label:"Retailer's Price",type:"number",errorMessage:"Retailer's Price is required"}),t.jsx(i,{onChange:r,name:"discount",span:"$",required:!0,value:(e==null?void 0:e.discount)??" ",label:"Discount",type:"number",errorMessage:"Discount is required"}),t.jsx(i,{onChange:r,span:"$",name:"after_discount",required:!0,value:String(parseFloat(e==null?void 0:e.retailers_price)-parseFloat((e==null?void 0:e.discount)??"0")),label:"Price After Discount",type:"number",errorMessage:"Price After Discount is required",readOnly:!0})]}),t.jsxs("div",{className:"flex gap-3 w-full",children:[t.jsx(i,{onChange:r,name:"cheque_no",required:!0,value:(e==null?void 0:e.cheque_no)??" ",label:"Cheque No.",type:"text",errorMessage:"Cheque No. is required"}),t.jsx(i,{onChange:r,name:"cheque_amount",span:"$",required:!0,value:(e==null?void 0:e.cheque_amount)??" ",label:"Cheque Amount",type:"number",errorMessage:"Cheque Amount is required"}),t.jsx(i,{onChange:r,name:"mail_date",required:!0,value:(e==null?void 0:e.mail_date)??" ",label:"Mail Date",type:"date",errorMessage:"Mail Date is required"})]}),t.jsxs("div",{className:"flex gap-3 ",children:[t.jsx(i,{onChange:r,name:"unit_cost",span:"$",required:!0,value:(e==null?void 0:e.unit_cost)??"0",label:"Cost of Unit",type:"text",errorMessage:"Cost of Unit is required"}),t.jsx(i,{onChange:r,name:"cube_weight",required:!0,value:(e==null?void 0:e.cubed_weight)??"0",label:"Cube Weight",type:"number",errorMessage:"Cube Weight is required"})]}),t.jsx("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Dimension"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(i,{onChange:r,name:"length",required:!0,value:(e==null?void 0:e.length)??"0",label:"Length",type:"number",errorMessage:"Length is required"}),t.jsx(i,{onChange:r,name:"width",required:!0,value:(e==null?void 0:e.width)??"0",label:"Width",type:"number",errorMessage:"Width is required"}),t.jsx(i,{onChange:r,name:"height",required:!0,value:(e==null?void 0:e.height)??"0",label:"Height",type:"number",errorMessage:"Height is required"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:N,type:"button",className:`w-96 flex items-center justify-center mr-12 py-2 ${c?"bg-blue-500":" bg-transparent  hover:bg-blue-50"}  text-blue-700 font-semibold px-4 border border-blue-500 rounded w-lg  shadow-sm shadow-black`,children:c?t.jsx(C,{}):"GET FEDEX RATES"}),t.jsx(i,{onChange:r,name:"shipping_cost",span:"$",required:!0,value:(e==null?void 0:e.shipping_cost)??"0",label:"Shipping Cost",type:"number",errorMessage:"Shipping Cost is required"}),t.jsx(i,{onChange:r,name:"estimated_cost",span:"$",required:!0,value:(e==null?void 0:e.estimated_cost)??"0",label:"Estimated Cost",type:"number",errorMessage:"Estimated Cost is required"})]}),t.jsx(q,{onChange:r,name:"instruction",required:!1,value:e.instruction??"",label:"Warranty Instruction",errorMessage:"",data:[{value:"",name:""},...e.country==="CA"?[{value:"CA Warehouse",name:"Return to (CA Warehouse)"}]:[],...e.country==="US"?[{value:"US Warehouse",name:"Return to (US Warehouse)"}]:[],{value:"home",name:"Destroy in Home"},{value:"asc",name:"Refer to ASC"}]}),t.jsx(q,{onChange:S,name:"email_template",value:"",label:"Email Templates",errorMessage:"",data:b.map(a=>({name:a.template_name,value:a.id}))}),t.jsx("div",{className:"my-12",children:t.jsx($,{label:"",name:"wysiwyg",value:(e==null?void 0:e.template_text)??null,onChange:r})}),t.jsx("div",{className:"my-6",children:t.jsx(i,{onChange:r,name:"notes",span:"",required:!0,value:(e==null?void 0:e.notes)??"",label:"Notes",type:"text",errorMessage:"Notes is required"})}),t.jsxs("div",{className:"mb-2 flex items-center justify-end gap-x-6",children:[t.jsx("button",{type:"button",className:"text-sm font-semibold leading-6 text-gray-900",children:"Cancel"}),t.jsx("button",{onClick:v,type:"submit",className:"rounded-sm bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:A?t.jsx("div",{className:"py-1",children:t.jsx(C,{})}):"Submit"})]})]})]})})}export{z as default};
